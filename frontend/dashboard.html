<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dhanâ‚¹ekha â€“ Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#22c55e">

  <link rel="shortcut icon" href="assets/icons/dashboard.png" type="image/png">
  <link rel="stylesheet" href="css/glass.css" />
  <link rel="stylesheet" href="css/dashboard.css" />
</head>
<body>

  <!-- Auth Guard -->
  <script src="js/authGuard.js"></script>



  <!-- Navbar -->
  <nav class="navbar glass-card">
    <div class="logo">
        <img src="assets/logo1.png" alt="Dhanâ‚¹ekha Logo" />
        <span>Dhanâ‚¹ekha</span>
    </div>

    <!-- Desktop Date Range (Center) -->
    <div id="navbarDateRange" class="navbar-date-range"></div>

    <div class="nav-actions">
      <button onclick="location.href='monthly.html'" class="nav-btn-profile">
        <span class="desktop-text">ðŸ“… Monthly</span>
        <span class="mobile-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg></span>
      </button>
      <button onclick="location.href='profile.html'" class="nav-btn-profile">
        <span class="desktop-text">ðŸ‘¤ Profile</span>
        <span class="mobile-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>
      </button>
      <button onclick="logout()">
        <span class="desktop-text">Logout</span>
        <span class="mobile-icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg></span>
      </button>
    </div>
  </nav>

  <!-- Mobile Date Range (Sticky below navbar) -->
  <div id="mobileDateRange" class="mobile-date-range glass-card"></div>

  <!-- Main Dashboard -->
  <main class="container">

    <!-- Balance Card -->
    <section class="balance-card glass-card">
      <div class="liquid-bg liquid-green" id="fillBalance"></div>
      <div class="card-content">
        <h3>Remaining Balance</h3>
        <p id="balance">â‚¹0</p>
        <p class="hover-percentage" id="pctBalance">0%</p>
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="actions">
      <button onclick="openExpense()">âž• New Expense</button>
      <button onclick="openIncome()">âž• Monthly Budget</button>
    </section>

    <!-- Summary Cards -->
    <section class="summary">
      <div class="summary-card glass-card">
        <div class="liquid-bg liquid-blue" id="fillIncome"></div>
        <div class="card-content">
          <h4>Total Income</h4>
          <p id="totalIncome">â‚¹0</p>
          <p class="hover-percentage" id="pctIncome">0%</p>
        </div>
      </div>
      <div class="summary-card glass-card">
        <div class="liquid-bg liquid-red" id="fillExpense"></div>
        <div class="card-content">
          <h4>Total Expense</h4>
          <p id="totalExpense">â‚¹0</p>
          <p class="hover-percentage" id="pctExpense">0%</p>
        </div>
      </div>
    </section>

    <!-- Add Expense Modal -->
<div id="expenseModal" class="modal hidden">
  <div class="modal-content glass-card">
    <h3>Add Expense</h3>

    <input type="number" id="expenseAmount" placeholder="Amount (â‚¹)" />
    
    <select id="expenseCategory">
      <option value="">Select Category</option>
      <option value="Food">Food</option>
      <option value="Travel">Travel</option>
      <option value="Rent">Rent</option>
      <option value="Shopping">Shopping</option>
      <option value="Other">Other</option>
    </select>

    <input type="date" id="expenseDate" />

    <input type="text" id="expenseDesc" placeholder="Description (optional)" />

    <div class="modal-actions">
      <button onclick="addExpense()">Save</button>
      <button class="cancel" onclick="closeExpense()">Cancel</button>
    </div>
  </div>
</div>

<!-- Add Income Modal -->
<div id="incomeModal" class="modal hidden">
  <div class="modal-content glass-card">
    <h3>Add Income</h3>

    <input type="number" id="incomeAmount" placeholder="Amount (â‚¹)" />
    <input type="text" id="incomeSource" placeholder="Source (Salary, Freelance)" />
    <input type="date" id="incomeDate" />

    <div class="modal-actions">
      <button onclick="addIncome()">Save</button>
      <button class="cancel" onclick="closeIncome()">Cancel</button>
    </div>
  </div>
</div>


<section class="filters glass-card">
  <div class="filter-group">
    <label>Date Range:</label>
    <div class="date-inputs">
      <input type="date" id="startDate" placeholder="dd-mm-yyyy">
      <input type="date" id="endDate" placeholder="dd-mm-yyyy">
    </div>
  </div>
  <div class="filter-actions">
    <button onclick="filterCharts()" class="btn-filter">Filter</button>
    <button onclick="resetFilters()" class="btn-reset">Reset</button>
  </div>
</section>

<!-- ANALYTICS CAROUSEL -->
<section class="analytics-carousel glass-card" style="margin-top: 30px;">
  <div class="carousel-container">
    <div class="carousel-track" id="analyticsTrack">
      
      <!-- Slide 1: Category Distribution -->
      <div class="carousel-slide">
        <h3>Spending by Category</h3>
        <div class="chart-wrapper">
          <canvas id="categoryChart"></canvas>
        </div>
      </div>

      <!-- Slide 2: Weekly Trend -->
      <div class="carousel-slide">
        <h3>Last 7 Days Trend</h3>
        <div class="chart-wrapper">
          <canvas id="weeklyChart"></canvas>
        </div>
      </div>

      <!-- Slide 4: Yearly Overview (New) -->
      <div class="carousel-slide">
        <h3>Yearly Income vs Expense</h3>
        <div class="chart-wrapper">
          <canvas id="yearlyChart"></canvas>
        </div>
      </div>

      <!-- Slide 5: Day of Week Analysis (New) -->
      <div class="carousel-slide">
        <h3>Busiest Spending Days</h3>
        <div class="chart-wrapper">
          <canvas id="dayOfWeekChart"></canvas>
        </div>
      </div>

    </div>
  </div>
  <div class="carousel-dots" id="carouselDots"></div>
</section>

<!-- Monthly Expenses (Standalone) -->
<section class="glass-card" style="margin-top: 30px; padding: 20px;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
    <h3 style="margin: 0;">Monthly Expenses</h3>
    <div style="display: flex; align-items: center; gap: 10px;">
      <span id="monthlyYearTotal" style="font-size: 0.9rem; font-weight: 600; color: #34d399;"></span>
      <select id="monthlyChartYear" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; border-radius: 6px; padding: 4px 8px; outline: none; cursor: pointer; font-size: 0.9rem;">
        <!-- Options populated by JS -->
      </select>
    </div>
  </div>
  <div class="chart-scroll-wrapper">
    <div id="monthlyChartContainer">
      <canvas id="monthlyChart"></canvas>
    </div>
  </div>
</section>



<!-- Expense List -->
<section class="expense-list glass-card">
  <div class="expense-header">
    <h3>Recent Expenses</h3>
    <button onclick="loadAllExpenses()">View All</button>
  </div>



  <div class="table-responsive">
    <table class="expense-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Amount</th>
          <th>Category</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody id="expenseTableBody">
        <tr><td colspan="4" style="text-align:center; padding: 20px;">Loading expenses...</td></tr>
      </tbody>
    </table>
  </div>
</section>



  </main>

  <button id="backToTopBtn" title="Back to Top">â†‘</button>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


  <script type="module" src="js/dashboard.js"></script>
</body>
</html>
